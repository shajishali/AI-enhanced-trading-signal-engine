<!DOCTYPE html>
<html>
<head>
    <title>JavaScript Debug Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .warning { background-color: #fff3cd; border-color: #ffeaa7; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background: #0056b3; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 3px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîç JavaScript Debug Test for Signals Page</h1>
    
    <div class="test-section">
        <h3>1. Basic JavaScript Test</h3>
        <button onclick="testBasicJS()">Test Basic JavaScript</button>
        <div id="basic-js-result"></div>
    </div>
    
    <div class="test-section">
        <h3>2. Fetch API Test</h3>
        <button onclick="testFetchAPI()">Test Fetch API</button>
        <div id="fetch-result"></div>
    </div>
    
    <div class="test-section">
        <h3>3. Signals API Test</h3>
        <button onclick="testSignalsAPI()">Test Signals API</button>
        <div id="signals-api-result"></div>
    </div>
    
    <div class="test-section">
        <h3>4. Browser Console Check</h3>
        <p>Open Developer Tools (F12) and check the Console tab for any error messages.</p>
        <button onclick="generateTestLogs()">Generate Test Logs</button>
        <div id="console-test-result"></div>
    </div>
    
    <div class="test-section">
        <h3>5. Manual Signals Loading Test</h3>
        <button onclick="manualLoadSignals()">Manually Load Signals</button>
        <div id="manual-load-result"></div>
    </div>
    
    <script>
        // Test 1: Basic JavaScript functionality
        function testBasicJS() {
            const resultDiv = document.getElementById('basic-js-result');
            try {
                // Test basic JavaScript
                const testArray = [1, 2, 3, 4, 5];
                const doubled = testArray.map(x => x * 2);
                
                resultDiv.innerHTML = `
                    <div class="success">
                        <h4>‚úÖ Basic JavaScript Working</h4>
                        <p>Array: [${testArray.join(', ')}]</p>
                        <p>Doubled: [${doubled.join(', ')}]</p>
                        <p>JavaScript execution is working properly.</p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå JavaScript Error</h4>
                        <p>Error: ${error.message}</p>
                    </div>
                `;
            }
        }
        
        // Test 2: Fetch API functionality
        function testFetchAPI() {
            const resultDiv = document.getElementById('fetch-result');
            resultDiv.innerHTML = '<p>Testing fetch API...</p>';
            
            // Test with a simple API
            fetch('https://httpbin.org/get')
                .then(response => response.json())
                .then(data => {
                    resultDiv.innerHTML = `
                        <div class="success">
                            <h4>‚úÖ Fetch API Working</h4>
                            <p>Successfully fetched data from external API.</p>
                            <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>
                    `;
                })
                .catch(error => {
                    resultDiv.innerHTML = `
                        <div class="error">
                            <h4>‚ùå Fetch API Error</h4>
                            <p>Error: ${error.message}</p>
                        </div>
                    `;
                });
        }
        
        // Test 3: Signals API test
        function testSignalsAPI() {
            const resultDiv = document.getElementById('signals-api-result');
            resultDiv.innerHTML = '<p>Testing signals API...</p>';
            
            fetch('/signals/api/signals/')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    return response.json();
                })
                .then(data => {
                    resultDiv.innerHTML = `
                        <div class="success">
                            <h4>‚úÖ Signals API Working</h4>
                            <p>Successfully fetched signals data.</p>
                            <p><strong>Signals found:</strong> ${data.signals ? data.signals.length : 0}</p>
                            ${data.signals && data.signals.length > 0 ? `
                                <p><strong>First signal:</strong></p>
                                <ul>
                                    <li>Timeframe: ${data.signals[0].timeframe || 'NOT FOUND'}</li>
                                    <li>Entry Point Type: ${data.signals[0].entry_point_type || 'NOT FOUND'}</li>
                                    <li>Entry Confidence: ${data.signals[0].entry_confidence || 'NOT FOUND'}</li>
                                </ul>
                            ` : '<p>No signals found in response.</p>'}
                        </div>
                    `;
                })
                .catch(error => {
                    resultDiv.innerHTML = `
                        <div class="error">
                            <h4>‚ùå Signals API Error</h4>
                            <p>Error: ${error.message}</p>
                            <p>This suggests the API is not accessible or there's a network issue.</p>
                        </div>
                    `;
                });
        }
        
        // Test 4: Generate console logs
        function generateTestLogs() {
            const resultDiv = document.getElementById('console-test-result');
            
            console.log('üîç Debug: Testing console logging...');
            console.log('üîç Debug: Current timestamp:', new Date().toISOString());
            console.log('üîç Debug: User agent:', navigator.userAgent);
            console.log('üîç Debug: Page URL:', window.location.href);
            
            resultDiv.innerHTML = `
                <div class="warning">
                    <h4>üìù Console Logs Generated</h4>
                    <p>Check your browser's Developer Console (F12 ‚Üí Console tab) for debug messages.</p>
                    <p>Look for any error messages in red.</p>
                </div>
            `;
        }
        
        // Test 5: Manual signals loading simulation
        function manualLoadSignals() {
            const resultDiv = document.getElementById('manual-load-result');
            resultDiv.innerHTML = '<p>Simulating signals loading...</p>';
            
            // Simulate the loadSignals function
            try {
                console.log('üîç Debug: Manual loadSignals called');
                
                // Simulate API call
                fetch('/signals/api/signals/')
                    .then(response => response.json())
                    .then(data => {
                        console.log('üîç Debug: API response received:', data);
                        
                        if (data.success && data.signals) {
                            resultDiv.innerHTML = `
                                <div class="success">
                                    <h4>‚úÖ Manual Signals Loading Successful</h4>
                                    <p>Loaded ${data.signals.length} signals</p>
                                    <p>Check console for detailed logs</p>
                                </div>
                            `;
                        } else {
                            resultDiv.innerHTML = `
                                <div class="error">
                                    <h4>‚ùå API Response Error</h4>
                                    <p>API returned: ${JSON.stringify(data)}</p>
                                </div>
                            `;
                        }
                    })
                    .catch(error => {
                        console.error('üîç Debug: API error:', error);
                        resultDiv.innerHTML = `
                            <div class="error">
                                <h4>‚ùå API Call Failed</h4>
                                <p>Error: ${error.message}</p>
                            </div>
                        `;
                    });
                    
            } catch (error) {
                console.error('üîç Debug: Function error:', error);
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Function Execution Error</h4>
                        <p>Error: ${error.message}</p>
                    </div>
                `;
            }
        }
        
        // Auto-run basic test when page loads
        window.onload = function() {
            console.log('üîç Debug: Page loaded, running basic tests...');
            testBasicJS();
        };
    </script>
</body>
</html>
